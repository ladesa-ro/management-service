{
  "$schema": "../../../../../node_modules/nx/schemas/project-schema.json",

  "namedInputs": {
    "default": ["{projectRoot}/generics/**/*", "{projectRoot}/resources/**/*"]
  },

  "targets": {
    "tsp:format": {
      "cache": false,
      "executor": "nx:run-commands",
      "options": {
        "commands": ["tsp format '{generics,resources}/**/*.tsp'"]
      }
    },

    "json-schema:generate": {
      "cache": true,
      "executor": "nx:run-commands",

      "inputs": ["default"],
      "outputs": ["{projectRoot}/.generated/*.json"],

      "options": {
        "cwd": "{projectRoot}",
        "commands": [
          "tsp compile --config ./tspconfig.yaml --output-dir ./.generated ./main.tsp"
        ],
        "parallel": false
      }
    },
    
    "typescript:generate": {
      "cache": true,
      "executor": "nx:run-commands",

      "inputs": ["default"],
      "outputs": ["{projectRoot}/.generated/*.ts"],

      "options": {
        "cwd": "{projectRoot}",
        "commands": [
          "quicktype --src-lang schema --src './.generated/Ladesa.ManagementService.Domain.Contracts.json#$defs/' -o './.generated/Ladesa.ManagementService.Domain.Contracts.ts' --just-types --no-nice-property-names --no-runtime-typecheck --acronym-style original"
        ],
        "parallel": false
      },

      "dependsOn": ["json-schema:generate"]
    }
  }
}